## 1장. 단위 테스트의 목적

단위 테스트는 테스트 코드를 작성하는 행위 그 이상이다. 

테스트 작성에 드는 **노력을 최소화**하고, 테스트로부터 얻는 **이점을 극대화**하는 것이 중요하다.  

<br>

### 1.1 단위 테스트의 현재 상황

대부분의 기업에서 단위 테스트가 필수적인 요소로 여겨지고 있고, 
일회성으로 버릴 프로젝트가 아닌 이상 **무조건 단위 테스트를 진행해야 한다.**

실제로 테스트들이 개발자가 기대하는 효과를 잘 내지 못하는 경우가 많다. 

이런 프로젝트에서는 기능 추가에도 시간이 오래 소요되고, 이미 구현된 기능에서도 계속해서 버그가 나타나고, 도움이 되어야 할 테스트들이 문제 해결에 기여하지 못하는 상황이 발생한다.

이러한 문제는 제대로된 단위 테스트가 없는 것에서 비롯된다.

--------

### 1.2 단위 테스트의 목표

> **단위 테스트의 목표는 소프트웨어 프로젝트의 지속 가능한 성장을 가능하게 만드는 것이다. (지속 가능성과, 확장성)**

단위 테스트를 수행하면 **더 나은 설계**를 하게 되지만 그것만이 단위 테스트의 주요 목적은 아니다.

<br>

단위 테스트는 **좋은 부정적 지표로 작용하지만, 좋은 긍정적 지표가 되진 않는다.**

단위 테스트로 상대적으로 높은 정확도로 낮은 품질의 코드를 확인할 수 있다.
낮은 품질은 보통 강한 결합(tight coupling)으로 드러난다. 
이는 프로덕션 코드들이 충분히 분리되어 있지 않다는 뜻이고 결과적으로 개별적으로 테스트하기 어렵게 만든다.

하지만, 단위 테스트는 좋은 긍정적 지표가 되진 않는다. 
코드를 쉽게 테스트할 수 있다고 해서 반드시 좋은 품질의 코드를 의미하지는 않는다.

<br>

**단위 테스트의 목표는 소프트웨어 프로젝트의 지속 가능한 성장을 가능하게 만드는 것이다.**

프로젝트의 성장을 지속시키는 것은 어렵다.

시간이 지남에 따라 코드가 점점 악화되는 형태로 나타나고, 코드를 수정할 때마다 그 안의 무질서함이 증가한다.

테스트는 이러한 경향을 뒤집는 역할을 수행한다.
새로운 기능을 도입하거나 리팩토링하더라도 기존 기능이 여전히 잘 작동하는지 확인해준다.

테스트의 단점은 초기 단계에서 노력이 필요하다는 점이다.
하지만 프로젝트 후반부에 테스트들이 스스로 그 비용을 상쇄해준다.

<br>

**단위 테스트는 프로젝트 성장을 유지하는데 도움이 되지만, 단순히 테스트를 작성하는 것만으로는 충분하지 않다.**

잘못 작성된 테스트는 결국 동일한 문제를 야기한다. **단위 테스트를 작성하는 것 자체가 목적이 되어버리면 안된다.**

테스트를 많이 추가한다고 해서 유닛 테스트의 목표를 이룰 수 있는 것이 아니고, 테스트의 가치와 유지비용을 모두 고려해야 한다.

- 테스트 비용
  - 기존 코드를 리팩토링할 때 테스트 코드를 함께 리팩토링 하는 시간
  - 코드가 변경될때마다 테스트를 실행하는 시간
  - 테스트가 발생시키는 거짓 경로를 처리하는 시간
  - 코드가 어떻게 작동되는지 이해하려고 할 때, 테스트를 읽는데 소요되는 시간
 
  

이러한 사항들을 고려하여 보유할 가치가 있는 테스트에 집중하여 지속 가능한 프로젝트 성장을 이뤄야 한다.

--------

### 1.3 테스트 품질 측정을 위한 커버리지 활용

커버리지 지표는 유용한 피드백을 줄 순 있지만, 테스트의 품질을 제대로 측정할 순 없다.

**코드 커버리지**     
테스트가 실행한 코드 라인 수와 전체 프로덕션 코드 라인 수의 비율을 나타낸다.       
코드를 수정하면 커버리지 수치가 달라질 수 있다. (실제로 품질 향상이 되지 않았음에도)

<br>

**분기 커버리지**     
if나 switch 같은 조건문에서 가능한 분기가 테스트에 의해 실행되었는지를 나타내는 지표이다.     
코드 라인 수가 아닌 논리 분기 수를 기준으로 계산되므로 코드 구조가 변경되어도 일관성을 유지한다.     

<br>  

커버리지 지표의 문제점
- 시스템이 생성할 수 있는 모든 결과를 테스트가 검증했다고 보장할 수 없음
- 외부 라이브러리 내의 코드 경로는 반영하지 못함

이에 따라 테스트 커버리지 지표만으로 테스트 품질을 판단하는 것은 충분하지 않다.    
**커버리지 지표는 목표가 아닌 지표로서 해석하는 것이 가장 좋다.**

--------

### 1.4 성공적인 테스트를 만드는 요인

신뢰할 수 있는 테스트 품질을 측정하는 방식은 각 테스트를 개별적으로 하나하나 평가하는 것이다.      
**좋은 테스트인지를 자동으로 판단할 수 없고 개발자 자신의 판단을 적용해야 한다.**

성공적인 테스트는 다음과 같은 속성을 갖고 있다.
- 개발 주기에 통합되어 있다.
- 코드 중 중요한 부분만을 타겟으로 한다.
    - 가장 중요한 비즈니스 로직을 담고 있는 영역, 도메인 모델을 테스트
- 최소한의 유지보수 비용으로 최대 가치를 제공한다.


<br>

## 느낀점

“테스트는 좋은 부정적 지표로 작용하지만, 좋은 긍정적 지표가 되진 않는다”는 문장에 깊이 공감했다.    
단순히 테스트 코드를 많이 작성하기보다는, 정말 필요한 비즈니스 로직을 중심으로 의미 있는 테스트를 잘 작성하는 것이 중요하다는 점을 다시 한 번 느꼈다.     

이전 프로젝트에서 리팩토링을 진행하며 테스트 코드 역시 함께 수정해야 했고, 그 과정에서 테스트 유지보수의 어려움을 경험한 적이 있다.    
앞으로 스터디를 통해 좋은 테스트란 무엇인지에 대한 감을 얻고, 이번 YAPP 프로젝트에서는 이를 바탕으로 효과적인 테스트 전략을 적용해보고 싶다. 




[1장 해석본 (w/GPT)](https://oval-second-abc.notion.site/1-201a2bc44c1c808599c2d1994bf64015?source=copy_link)
